System.register("chunks:///main.js",["cc"],(function(){"use strict";var t,e,i,n,r,o,a,s,u,l,c,p,h;return{setters:[function(_){t=_.cclegacy,e=_._decorator,i=_.Animation,n=_.SkeletalAnimation,r=_.input,o=_.Input,a=_.Vec3,s=_.Component,u=_.Prefab,l=_.CCInteger,c=_.Node,p=_.Label,h=_.instantiate}],execute:function(){function _(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function d(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,m(t,e)}function m(t,e){return(m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function b(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function v(t,e,i,n,r){var o={};return Object.keys(n).forEach((function(t){o[t]=n[t]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),o),r&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(r):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(t,e,o),o=null),o}var g,S,P,T,N,I,E;t._RF.push({},"b63caL6hP9OnpNTPQ/rTZnO","PlayerController",void 0);var w,A,B,C,O,M,j,G,J,z,L,k,R,U=e.ccclass,x=e.property,D=(g=U("PlayerController"),S=x({type:i}),P=x({type:n}),g((I=v((N=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return y(b(e=t.call.apply(t,[this].concat(n))||this),"BodyAnim",I,b(e)),y(b(e),"CocosAnim",E,b(e)),f(b(e),"_startJump",!1),f(b(e),"_jumpStep",0),f(b(e),"_currentJumpTime",0),f(b(e),"_jumpTime",.1),f(b(e),"_currentJumpSpeed",0),f(b(e),"_currentPosition",new a),f(b(e),"_deltaPosition",new a(0,0,0)),f(b(e),"_targetPosition",new a),f(b(e),"_isMoving",!1),f(b(e),"_currentMoveIndex",0),e}d(e,t);var i=e.prototype;return i.start=function(){},i.reset=function(){this._currentMoveIndex=0},i.setInputActive=function(t){t?r.on(o.EventType.MOUSE_UP,this.onMouseUp,this):r.off(o.EventType.MOUSE_UP,this.onMouseUp,this)},i.onMouseUp=function(t){0===t.getButton()?this.jumpByStep(1):2===t.getButton()&&this.jumpByStep(2)},i.jumpByStep=function(t){this._isMoving||(this._startJump=!0,this._jumpStep=t,this._currentJumpTime=0,this._currentJumpSpeed=this._jumpStep/this._jumpTime,this.node.getPosition(this._currentPosition),a.add(this._targetPosition,this._currentPosition,new a(this._jumpStep,0,0)),this._isMoving=!0,this.CocosAnim&&(this.CocosAnim.getState("cocos_anim_jump").speed=3.5,this.CocosAnim.play("cocos_anim_jump")),this.BodyAnim&&(1===t||2===t&&this.BodyAnim.play("twoStep")),this._currentMoveIndex+=t)},i.onOnceJumpEnd=function(){this._isMoving=!1,this.CocosAnim&&this.CocosAnim.play("cocos_anim_idle"),this.node.emit("JumpEnd",this._currentMoveIndex)},i.update=function(t){this._startJump&&(this._currentJumpTime+=t,this._currentJumpTime>this._jumpTime?(this.node.setPosition(this._targetPosition),this._startJump=!1,this.onOnceJumpEnd()):(this.node.getPosition(this._currentPosition),this._deltaPosition.x=this._currentJumpSpeed*t,a.add(this._currentPosition,this._currentPosition,this._deltaPosition),this.node.setPosition(this._currentPosition)))},e}(s)).prototype,"BodyAnim",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=v(N.prototype,"CocosAnim",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=N))||T);t._RF.pop(),t._RF.push({},"6097aeAgDpB+qoIvAEEJNnu","GameManager",void 0);var F,Y,Z=e.ccclass,q=e.property;!function(t){t[t.BT_NONE=0]="BT_NONE",t[t.BT_STONE=1]="BT_STONE"}(F||(F={})),function(t){t[t.GS_INIT=0]="GS_INIT",t[t.GS_PLAYING=1]="GS_PLAYING",t[t.GS_END=2]="GS_END"}(Y||(Y={}));w=Z("GameManager"),A=q({type:u}),B=q({type:l}),C=q({type:D}),O=q({type:c}),M=q({type:p}),w((J=v((G=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return y(b(e=t.call.apply(t,[this].concat(n))||this),"cubePrefab",J,b(e)),y(b(e),"roadLength",z,b(e)),y(b(e),"playerController",L,b(e)),y(b(e),"startMenu",k,b(e)),y(b(e),"stepsLabel",R,b(e)),f(b(e),"_road",[]),f(b(e),"_currentState",Y.GS_INIT),e}d(e,t);var i,n,r,o=e.prototype;return o.start=function(){var t;this.currentState=Y.GS_INIT,null===(t=this.playerController)||void 0===t||t.node.on("JumpEnd",this.onPlayerJumpEnd,this)},o.init=function(){this.startMenu&&(this.startMenu.active=!0),this.generateRoad(),this.playerController&&(this.playerController.setInputActive(!1),this.playerController.node.setPosition(a.ZERO)),this.playerController.reset()},o.onStartButtonClicked=function(){this.currentState=Y.GS_PLAYING},o.generateRoad=function(){this.node.removeAllChildren(),this._road=[],this._road.push(F.BT_STONE);for(var t=1;t<this.roadLength;t++)this._road[t-1]===F.BT_NONE?this._road.push(F.BT_STONE):this._road.push(Math.floor(2*Math.random()));for(var e=0;e<this._road.length;e++){var i=this.spawnBlockByType(this._road[e]);i&&(this.node.addChild(i),i.setPosition(e,-1.5,0))}},o.spawnBlockByType=function(t){if(!this.cubePrefab)return null;var e=null;switch(t){case F.BT_STONE:e=h(this.cubePrefab)}return e},o.onPlayerJumpEnd=function(t){this.stepsLabel.string=""+t,this.checkResult(t)},o.checkResult=function(t){t<=this.roadLength?this._road[t]===F.BT_NONE&&(this.currentState=Y.GS_INIT):this.currentState=Y.GS_INIT},i=e,(n=[{key:"currentState",set:function(t){var e=this;switch(t){case Y.GS_INIT:this.init();break;case Y.GS_PLAYING:this.startMenu&&(this.startMenu.active=!1),this.stepsLabel&&(this.stepsLabel.string="0"),setTimeout((function(){e.playerController&&e.playerController.setInputActive(!0)}),.1);break;case Y.GS_END:}this._currentState=t}}])&&_(i.prototype,n),r&&_(i,r),e}(s)).prototype,"cubePrefab",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=v(G.prototype,"roadLength",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),L=v(G.prototype,"playerController",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=v(G.prototype,"startMenu",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=v(G.prototype,"stepsLabel",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=G));t._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///main.js'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});